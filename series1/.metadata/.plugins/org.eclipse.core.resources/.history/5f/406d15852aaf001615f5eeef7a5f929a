module volume

import lang::java::jdt::m3::Core;
import IO;
import String;
import lang::java::m3::Core;
import vis::Figure;
import vis::Render;

int volume (model) {
	 //model = createM3FromEclipseProject(|project://SmallSQL/|);
	 return (0 | it + classVolume(c) | c <- classes(model));
}

void visTree(loc root, rel[loc from, loc to] containments)
{
	t = tree(box(text(root.uri), fillColor("blue")), [tree(g,containments) | g<-containments[root]]);
	render(t);	
}

void drawVolumeTree(model)
{
	
	b = box(text("alma"), gap(2), fillColor("lightyellow"));
	render(b);
}

int lines(elem) {
	f = readFile(elem);
	allCode = (0 | it + 1 | /.*[^\s].*\n/ := f); 
	comments = ([] | it+c | /<c:\/\*.*?\*\/>/s := f);
	int commentLineCount = 0;
	for (c <- comments)
	{
		commentLineCount = commentLineCount + (0 | it + 1 | /.*[^\s].*\n/ := c);
	}
	return allCode - commentLineCount;
}